
opp-tools is a collection of tools to track academic papers uploaded
to (or linked from) certain web pages.

version 0.5 (2010-06-12)

---------------------------------------------------------------------
INSTALLATION AND SETUP
---------------------------------------------------------------------

To process documents in various formats, a few additional software
packages are required:

pdftohtml (Poppler version)
pdftk
cuneiform 0.9
convert (ImageMagick)
ps2pdf
antiword
wkhtmltopdf

On Ubuntu 10.04, the following installs everything except cuneiform:

sudo apt-get install poppler-utils pdftk imagemagick ghostscript
antiword wkhtmltopdf

The cuneiform version in the standard repositories is too old. For
Debian-based systems, you can get cuneiform 0.9 from
http://notesalexp.org/. Otherwise see
https://launchpad.net/cuneiform-linux/.

Finally, make sure you have the following CPAN Perl modules:

HTML::LinkExtractor
HTML::Encoding
HTML::Strip
HTML::TreeBuilder
XML::Writer
XML::XPath
Text::Capitalize
String::Approx

Now set up a MySQL database to store the tracked pages and papers. To
create the tables, call

mysql -u dbuser -p dbpass dbname < setup.sql 

Then copy config-example.pl to config.pl and adjust the values for the
database connection and the installation path.

Now you can call process_pages to look for (new) links on the tracked
pages, and process_links to extract information from (new) papers
found behind these links. At this point there aren't any pages in the
database yet. To test the setup, you might try

INSERT INTO authors (name) VALUES ('David Chalmers');
INSERT INTO pages (url, author, registered) VALUES 
  ('http://consc.net/papers.html', 
  (SELECT id FROM authors LIMIT 1), NOW());

perl process_pages -v2
perl process_links -v2


---------------------------------------------------------------------
INTERNALS
---------------------------------------------------------------------

Here is a flowchart of the steps in process_links.pl. Boxed terms
stand for applications that are part of opp-tools, underlined ones
denote other applications that may also be installed. Capitalised
steps without boxes are performed directly in process_link.pl.


                              url

                               |
                               V
                                      server error?   
                             FETCH    unsupported filetype?
                               &      intermediate page?
                            CONFIRM  --------------------->  STORE
                                     
                               |
                               |
         if plain text         V
             available      
     +---------+  <-------   SPAM      spam?
     | RFILTER |  ------->   CHECK   -------->  STORE
     +---------+          
                               |
                _______________|________________
               |         |           |          |
               | ps?     | pdf?      | doc?     | html?
               |         |           | rtf?     | txt?
               V         V           V          V
                      +------+              +-------+
            ps2pdf -> | RPDF | <- antiword  | RHTML | 
            ------    +------+    --------  +-------+
                         |                      |
                         |_____ ________________|
                               |
                               V
                          +---------+   
                          |  TIDY   |  
                          +---------+   
                               |
                               V

                            ENRICH    

                               |
                               V
                          +---------+   
                          |  META   |  
                          +---------+   
                               |
                               V
                          
     +---------+  <-------   SPAM      spam?
     | RFILTER |  ------->   CHECK   -------->  STORE
     +---------+          
                               |
                               V
 
                             STORE



