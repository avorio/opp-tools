YUI.add("rg-container-hover",function(a){a.namespace("rg.plugins"),a.rg.plugins.ContainerHover=a.Base.create("ContainerHover",a.Plugin.Base,[],{initializer:function(){var a=this.get("host"),b=this.get("itemSelector"),c=this.get("_handles");b?c.push(a.delegate("hover",this._overFn,this._outFn,b,this)):c.push(a.on("hover",this._overFn,this._outFn,this))},destructor:function(){a.Array.each(this.get("_handles"),function(a){a.detach()})},_overFn:function(a){var b=this.get("overCallback");a.currentTarget.addClass(this.get("cssClasses")),b&&b.call(this.get("overCtx"),a)},_outFn:function(a){var b=this.get("outCallback");a.currentTarget.removeClass(this.get("cssClasses")),b&&b.call(this.get("outCtx"),a)}},{NS:"ContainerHover",ATTRS:{_handles:{value:[]},itemSelector:{},cssClasses:{value:"hover"},overCtx:{value:null},overCallback:{value:null},outCtx:{value:null},outCallback:{value:null}}})},"0.0.1",{requires:["event-hover"]});
YUI.add("rg-confirm",function(a){a.namespace("rg"),a.rg.confirm=function(b){if(b.hasInputBox){if(b.body=a.Node.create("<p>"+b.body+"</p>"),b.inputBoxLabel){var c=a.Node.create("<label>"+b.inputBoxLabel+"</label>");b.body.appendChild(c)}var d=a.Node.create('<input type="text" class="js-confirm-input" class="text"/>');b.body.appendChild(d)}b=a.merge({headerContent:"<h4>"+b.header+"</h4>",bodyContent:b.body,footerContent:"",zIndex:1100,render:!0,visible:!1,plugins:[{fn:a.rg.widget.OverlayPopup,cfg:{handleResize:!0,hideOnClickOutside:!1}}]},b);var e,f,g=new a.rg.widget.Dialog(b),h=g.getStdModNode(a.WidgetStdMod.FOOTER);g.get("contentBox").addClass("confirm-dialog"),g.get("contentBox").one(".close a").remove(!0),e=a.Node.create("<div></div>"),e.addClass("confirm-actions rf"),a.Array.each(b.buttons,function(b){var c=a.Node.create("<a></a>");c.set("href","javascript:;"),c.addClass("btn btn-margin btn-confirm-dialog"),b.primary?c.addClass("btn-promote"):b.attention?c.addClass("btn-attention"):c.addClass("btn-plain"),c.setContent(b.label),c.set("id",b.id),e.append(c)}),h.append(e),f=a.Node.create('<div class="clear"></div>'),h.append(f);var i=function(){var a;return b.hasInputBox&&(a=g.bodyNode.one(".js-confirm-input").get("value")),a};return g.get("boundingBox").on("key",function(){h.one("#confirm")&&(g.hide(),g.destroy(),b.callback.call(b.context||this,"confirm",i()))},"enter",this),g.get("boundingBox").on("key",function(){h.one("#cancel")&&(g.hide(),g.destroy(),b.callback.call(b.context||this,"cancel",i()))},"esc",this),h.all(".btn-confirm-dialog").on("click",function(a){g.hide(),g.destroy(),b.callback&&b.callback.call(b.context||this,a.target.get("id"),i())},this),g.show(),g}},"0.2.0",{requires:["rg-overlay","overlay","event-key"]});
YUI.add("rg.views.publicprofile.ProfileHeaderView",function(a){a.namespace("rg.views.publicprofile"),a.rg.views.publicprofile.ProfileHeaderView=a.Base.create("publicprofile.ProfileHeaderView",a.rg.WidgetView,[],{afterRendered:function(){var b=this.get("container");b.one(".profile-header-personal").plug(a.rg.plugins.ContainerHover,{}),b.all(".prize-badge").each(function(b){var c=b.getData("description");c&&b.plug(a.rg.widget.TooltipPlugin,{content:c,align:"bottom"})}),this.data.showMessageDialog&&this.showMessageDialog(),this.data.profileUpdateMessage&&a.rg.confirm({header:"",body:this.data.profileUpdateMessage,buttons:[{id:"cancel",primary:!0,label:"OK"}]}),this.get("suggestionFeedbackDialogParams")&&a.rg.loadWidgetInDialog("profile.AuthorSuggestionFeedbackDialog.html",this.get("suggestionFeedbackDialogParams"))},showMessageDialog:function(){a.rg.loadWidgetInDialog("messages.MessageCreateDialog.html",{account_key:this.data.accountKey})}},{ATTRS:{suggestionFeedbackDialogParams:{}}})},"0.0.1",{requires:["rg-container-hover","rg-tooltip","rg-confirm"]});
"use strict";YUI.add("rg.views.publicprofile.ProfileFollowButtonView",function(a){a.namespace("rg.views.publicprofile"),a.rg.views.publicprofile.ProfileFollowButtonView=a.Base.create("publicprofile.ProfileFollowButtonView",a.rg.WidgetView,[],{events:{".js-follow":{click:"handleFollow"},".js-follow-dialog":{click:"followProfile"}},handleFollow:function(b){b.preventDefault();var c,d=a.one("#content");c=this.get("container").one(".js-follow"),c.addClass("btn-disabled"),d.addClass("rendering"),a.rg.ajax(this.data.followAction,this.data.followParams,function(b){if(b.success)a.rg.loadWidget(window.location.href,{},function(a){a.render({replaceContent:d,after:function(){d.removeClass("rendering")}})},this),this.get("showMoreFollowSuggestionsDialog")&&this.get("accountKey")&&a.rg.loadWidget("profile.MoreFollowSuggestionsDialog.html",{accountKey:this.get("accountKey")},function(a){a.render({dialog:{}})});else{var c=b.errors.message;c||(c=b.errors),a.rg.notify(c,"warning")}},this,null,"POST")},followProfile:function(){this.get("preSignUpDialogContext")?a.rg.loadWidgetInDialog("publictopics.PreSignUpDialog.html",{context:this.get("preSignUpDialogContext")}):a.rg.loadWidgetInDialog("publicprofile.FollowProfileSignupDialog.html",{accountKey:this.get("accountKey")})}},{ATTR:{showMoreFollowSuggestionsDialog:{value:!1},accountKey:{},preSignUpDialogContext:{}}})},"1.0.0",{requires:["rg-header-notify"]});
YUI.add("rg.views.publicprofile.ProfileImageView",function(a){a.namespace("rg.views.publicprofile"),a.rg.views.publicprofile.ProfileImageView=a.Base.create("publicprofile.ProfileImageView",a.rg.WidgetView,[],{events:{".js-edit":{click:"editImage"},global:{"editImage:imageChanged":"imageChanged"}},afterRendered:function(){this.data.editImageDialog&&this.editImage()},editImage:function(b){b&&b.preventDefault();var c=this,d=this.get("experimentSource"),e={account_key:c.data.accountKey,useWebCam:this.get("useWebCam")};d&&(e.experimentSource=d),this.get("suggestedImage")&&(e.suggestedImage=this.get("suggestedImage")),a.rg.loadWidgetInDialog("profile.ProfileImageEditDialog.html",e)},imageChanged:function(){var b=this,c=this.get("experimentSource"),d={account_key:b.data.accountKey};c&&(d.experimentSource=c),a.rg.loadWidget("publicprofile.ProfileImage.html?dbw=true",d,function(a){a.render({replace:b.get("container")})})}},{ATTRS:{experimentSource:{},suggestedImage:{},useWebCam:{value:!1}}})},"0.0.1",{requires:["rg-anim"]});
YUI.add("rg.views.publicprofile.ProfileMenuView",function(a){a.namespace("rg.views.publicprofile"),a.rg.views.publicprofile.ProfileMenuView=a.Base.create("publicprofile.ProfileMenuView",a.rg.WidgetView,[],{events:{global:{"profilerMenu:menuItemChanged":"menuItemChanged","profileContributionsFilterMenu:submenuItemChanged":"contributionsMenuItemChanged","profileContributionsFilterMenu:menuItemChanged":"contributionsMenuItemChanged"}},menuItemChanged:function(a){var b=this.get("container");b.all("a").removeClass("selected"),b.one(a.additionalEventPayload).addClass("selected")},contributionsMenuItemChanged:function(){this.menuItemChanged({additionalEventPayload:".contributions"})}})},"0.0.1",{requires:[]});
YUI.add("rg.views.profile.ProfileContributionsContentView",function(a){a.namespace("rg.views.profile"),a.rg.views.profile.ProfileContributionsContentView=a.Base.create("profile.ProfileContributionsContentView",a.rg.WidgetView,[],{events:{global:{"ProfilePublicationsEditOverviewView:editingMode":"editingMode","ProfilePublicationsEditOverviewView:updatePublicationList":"updatePublicationList"},".js-cancel-editing":{click:"cancelEditingClickHandler"},".js-remove-publications":{click:"removePublicationsFromProfileClickHandler"},".js-close-edit-dialog":{click:"closeEotClickHandler"},".js-remove-btn":{click:"removePublicationFromStatusPanelClickHandler"}},initializer:function(){this.handles=[]},destructor:function(){a.Array.each(this.handles,function(a){a.detach()}),this.handles=[]},afterRendered:function(){this.publications={},this.publicationUids=[],this.reloadUrl=null,this.cancelUrl=null,this.pushedPublicationCount=null,this.isStatusPanelInitialized=!1,this.data.isEditMode&&a.fire("ProfilePublicationsEditOverviewView:triggerEditingMode")},editingMode:function(b){this.isStatusPanelInitialized?this.publicationUids.length>0&&a.fire("ProfilePublicationsEditOverviewView:highlightSelected",this.publicationUids):(this.isStatusPanelInitialized=!0,this.reloadUrl=b.reloadUrl,this.cancelUrl=b.cancelUrl,this.closePromoUrl=this.reloadUrl,this.pushedPublicationCount=b.pushedPublicationCount,this._initStatusPanel())},updatePublicationList:function(a){a.selected?this._addPublicationToStatusPanel(a):this._removePublicationFromStatusPanel(a.uid)},cancelEditingClickHandler:function(){var b=this.get("container");b.one(".js-panel-body").addClass("loading"),this.closePromoUrl=this.cancelUrl,a.rg.loadWidget(this.data.editDialogEotUrl,null,function(a){b.one(".js-panel-body").removeClass("loading"),a.success?(a.render({replaceContent:b.one(".js-panel-body-promos")}),this.showPromo()):(this._loadPublicationOverview(this.cancelUrl),b.removeClass("publications-batch-edit"),this._finishEditingMode())},this)},showPromo:function(){var b=this.get("container");b.one(".js-panel-body").hide(),b.one(".js-panel-body-promos").show(),b.one(".js-cancel-editing").hide(),b.one(".js-remove-publications").hide(),b.one(".js-close-edit-dialog").show(),a.fire("ProfilePublicationsEditOverviewView:disableEditPublicationsList")},closeEotClickHandler:function(){this._loadPublicationOverview(this.closePromoUrl),this.get("container").removeClass("publications-batch-edit"),this._finishEditingMode()},removePublicationsFromProfileClickHandler:function(){var b=this,c="Are you sure you want to remove "+(this.publicationUids.length>1?"these "+this.publicationUids.length+" publications":"this publication")+" from your profile?",d=this.get("container");this.closePromoUrl=this.reloadUrl,d.one(".js-remove-publications").addClass("btn-disabled"),a.rg.confirm({header:"Remove publication"+(this.publicationUids.length>1?"s":""),body:c,buttons:[{id:"no",label:"Cancel"},{id:"yes",label:"Remove"}],callback:function(c){if("yes"===c){var e={publicationUids:b.publicationUids};a.rg.ajaxDbwAware("literature.AjaxPublicationAuthorship.removePublicationsByUids.html",e,function(c){return c.success?void a.rg.loadWidget(this.data.editDialogEotUrl,e,function(e){d.one(".js-panel-body").removeClass("loading"),e.success?(e.render({replaceContent:d.one(".js-panel-body-promos")}),this.showPromo()):(a.rg.notify(c.result[0],"promo"),b._loadPublicationOverview(b.reloadUrl),b._finishEditingMode())},this):(a.rg.notify(c.result[0],"warning"),void this.get("container").one(".js-remove-publications").removeClass("btn-disabled"))},b,null,"POST")}else b.get("container").one(".js-remove-publications").removeClass("btn-disabled")}})},removePublicationFromStatusPanelClickHandler:function(a){a&&(a.stopPropagation(),a.preventDefault(),a.currentTarget.getData("uid")&&this._removePublicationFromStatusPanel(a.currentTarget.getData("uid")))},_addPublicationToStatusPanel:function(b){this.publications[b.uid]=b.name,this.publicationUids.push(b.uid),this._updateStatusPanel();var c=this.get("container"),d=c.one(".js-selected-publications-list"),e=this._createNode(b.name,b.uid);d.append(e),a.rg.highlight(e,null,{duration:3})},_removePublicationFromStatusPanel:function(b){delete this.publications[b],this.publicationUids.splice(this.publicationUids.indexOf(b),1),this._updateStatusPanel();var c,d=this.get("container"),e=d.one(".js-selected-publications-list");e.empty();for(var f in this.publicationUids)this.publicationUids.hasOwnProperty(f)&&(c=this.publicationUids[f],e.append(this._createNode(this.publications[c],c)));a.fire("ProfilePublicationsEditOverviewView:removeHighlight",b)},_updateStatusPanel:function(){var a=this.get("container"),b=this.publicationUids.length,c="Remove "+b+" publication",d="You've chosen to remove the following publication from your profile:";b>0?(a.one(".js-default-empty-text").hide(),a.one(".js-pushed-publications-empty-text").hide(),a.one(".selected-publications").show(),a.one(".js-cancel-editing").set("text","Cancel"),b>1&&(c+="s",d="You've chosen to remove the following publications from your profile:"),a.one(".js-selected-pubs-header").set("text",d),a.one(".js-remove-publications").set("text",c),a.one(".js-remove-publications").show()):(this.pushedPublicationCount?a.one(".js-pushed-publications-empty-text").show():a.one(".js-default-empty-text").show(),a.one(".selected-publications").hide(),a.one(".js-remove-publications").hide(),a.one(".js-cancel-editing").set("text","Close"))},_loadPublicationOverview:function(b){this.get("container").one(".profile-content-wrapper").addClass("rendering"),a.rg.loadWidget(b,null,function(a){a.success&&(this.get("container").one(".profile-content-wrapper").removeClass("rendering"),a.render({replaceContent:this.get("container").one(".profile-content-wrapper")}))},this)},_finishEditingMode:function(){var b=this.get("container");b.one(".js-selected-publications-list")&&b.one(".js-selected-publications-list").empty(),b.one(".js-edit-status-panel").hide(),b.one(".js-c-col-right-overlay").hide(),b.one(".js-remove-publications").removeClass("btn-disabled"),b.one(".js-cancel-editing").show(),b.one(".js-remove-publications").show(),b.one(".js-close-edit-dialog").hide(),b.one(".js-close-edit-dialog").hide(),b.one(".js-publications-container").removeClass("disabled"),b.one(".js-panel-body").show(),b.one(".js-panel-body-promos").hide(),this.isStatusPanelInitialized=!1,this.publications={},this.publicationUids=[],this._updateStatusPanel(),a.fire("ProfilePublicationsView:showUpdateDialogUrl")},_initStatusPanel:function(){var b=this.get("container");b.addClass("publications-batch-edit"),b.one(".js-edit-status-panel").show(),b.one(".js-c-col-right-overlay").show(),this.anchorTop=this.get("fixedPanelOffsetTop");var c=this;b.one(".js-edit-status-panel")&&(this._toggleStickyPanel(),this.handles.push(a.on("scroll",function(){c._toggleStickyPanel.call(c)}))),this._setPanelBodyMaxHeight(),this._setPanelPushedPublicationCount(),this.handles.push(a.on("windowresize",function(){c._setPanelBodyMaxHeight.call(c)}))},_createNode:function(b,c){var d='<li class="pub-item-small"><span class="ico-pub"></span><span>'+b+'</span><div class="indent-right"><a href="javascript:void(0);" class="rf remove-btn js-remove-btn" data-uid='+c+'><span class="ico-x-close-dark"></span></a></div></li>';return a.Node.create(d)},_setPanelPushedPublicationCount:function(){var a=this.get("container");this.pushedPublicationCount?(a.one(".js-pushed-publications-empty-text").show(),a.one(".js-count").setContent(this.pushedPublicationCount),1===this.pushedPublicationCount?a.one(".js-pushed-publications-single").show():a.one(".js-pushed-publications-multiple").show()):a.one(".js-default-empty-text").show()},_setPanelBodyMaxHeight:function(){var b=this.get("container"),c=b.one(".js-edit-status-panel");if(c){var d=a.one("body").get("winHeight"),e=b.one(".panel-footer").get("offsetHeight"),f=parseInt(b.one(".panel-body").getStyle("paddingTop"),10),g=parseInt(b.one(".panel-body").getStyle("paddingBottom"),10),h=parseInt(b.one(".edit-status-panel").getStyle("borderTop"),10),i=parseInt(b.one(".edit-status-panel").getStyle("borderBottom"),10),j=d-e;j=j-f-g,j=j-h-i,c.hasClass("sticky")?j-=this.get("fixedPanelOffsetBottom"):j=j-this.get("fixedPanelOffsetTop")-this.get("fixedPanelOffsetBottom"),a.one(".panel-body").setStyle("maxHeight",j)}},_toggleStickyPanel:function(){var a=this.get("container"),b=a.one(".js-edit-status-panel");b&&(this.anchorTop<window.scrollY?b.addClass("sticky"):b.removeClass("sticky"),this._setPanelBodyMaxHeight())}},{ATTRS:{fixedPanelOffsetTop:{value:230},fixedPanelOffsetBottom:{value:50}}})},"1.0.0",{requires:["rg-confirm"]});
YUI.add("rg-expander",function(a){a.namespace("rg.plugins"),a.rg.plugins.Expander=a.Base.create("Expander",a.Plugin.Base,[],{initializer:function(b){this.container=this.get("host");var c=this.container.get("offsetHeight"),d=this.container.get("scrollHeight");if(this.set("collapsedHeight",c),d>c||b.forceShowLoadMore){var e=a.Node.create("<div></div>"),f=a.Node.create("<a></a>"),g=a.Node.create("<span></span>");e.addClass("less-new-line"),g.setContent(this.get("expandLinkText")),f.addClass(this.get("toggleLinkClass")),f.addClass("expand-link"),f.on("click",this.toggle,this),f.append(g),this.container.append(e),this.container.append(f),this.toggleLink=f,this.toggleLinkText=g}else this.container.setStyle("maxHeight","none")},toggle:function(a){a&&a.preventDefault(),this.container.hasClass(this.get("containerCollapsedClass"))?(this.container.removeClass(this.get("containerCollapsedClass")),this.toggleLinkText.setContent(this.get("collapseLinkText")),this.toggleLink.removeClass("expand-link").addClass("collapse-link"),this.container.setStyle("maxHeight","none"),this.container.fire("expand")):(this.container.addClass(this.get("containerCollapsedClass")),this.toggleLinkText.setContent(this.get("expandLinkText")),this.toggleLink.removeClass("collapse-link").addClass("expand-link"),this.container.setStyle("maxHeight",this.get("collapsedHeight")),this.container.fire("collapse"))}},{NS:"Expander",ATTRS:{collapseLinkText:{value:"[less]"},expandLinkText:{value:"[more]"},toggleLinkClass:{value:"js-expander-toggle"},containerCollapsedClass:{value:"js-expander-collapsed"},collapsedHeight:{value:null}}})},"0.0.1",{requires:["event-hover"]});
"use strict";YUI.add("rg-overlay-extension",function(a){a.namespace("rg.widget");var b="rg-overlay-dark",c=!1;!function(){function d(d,e,g,h,i,j,k,l,m){return m===!0?(a.one("body").addClass(b),c=!0):(a.one("body").removeClass(b),c=!1),f.call(a.rg,d,e,g,h,i,j,k,l),m}function e(){var b='<div class="close"><a class="dialog-close js-dialog-close" href="javascript:" onclick="return false;"></a></div>',d=function(){var d,e,f,g;d=this.get("host"),e=d.get("contentBox"),e.setStyle("position","relative"),f=a.Node.create(b),g=f.one(".js-dialog-close"),c?g.setContent('<span class="ico-close-bold-big"></span><span class="ico-close-bold-big-hover"></span>'):g.setContent('<span class="ico-x-close-light"></span>'),e.append(f),g.on("click",d.hide,d)};this.afterHostMethod("renderUI",d,this)}var f=a.rg.loadWidgetInDialog;a.rg.loadWidgetInDialog=d,a.rg.widget.OverlayCloseable.prototype.initializer=e}()},{requires:["rg-overlay"]});
"use strict";YUI.add("rg.views.publicliterature.PublicationItemView",function(a){a.namespace("rg.views.publicliterature"),a.rg.views.publicliterature.PublicationItemView=a.Base.create("publicliterature.PublicationItemView",a.rg.WidgetView,[],{events:{".js-toggle-abstract":{click:"collapse"},".js-context-show-more-link":{click:"showMoreContext"},".action-remove":{click:"remove"},".action-follow":{click:"toggleFollow"},".action-download":{click:"download"},".action-request.primary":{click:"requestPrimary"},".action-request.image":{click:"requestImage"},".action-departmentremove":{click:"removeFromDepartmentpage"},".action-profileremove":{click:"removeFromProfile"},".js-remove-citation":{click:"removeCitationPublication"},".action-share":{click:"sharePublication"},".action-request-external":{click:"externalPublicationRequest"}},publicationBookmarkEndpoint:"literature.AjaxFollowPublication.html",publicationAuthorshipEndpoint:"literature.AjaxPublicationAuthorship.html",initializer:function(){var a="fulltextPreviewClosed:publicationUid-"+this.data.publicationUid;this.events.global||(this.events.global={}),this.events.global[a]="onPreviewClosed"},afterRendered:function(){var b=this.get("container");b.plug(a.rg.plugins.ContainerHover,{cssClasses:"list-hover"});var c=b.one(".js-pending");c&&c.plug(a.rg.widget.TooltipPlugin,{content:b.one(".info-tooltip-content").getContent(),align:"right",arrowOffset:[10,0],overlayOffset:[10,0]});var d={};this.data.displayUpdatedExpanderPlugin&&(d.expandLinkText="+ more",d.collapseLinkText="- less"),this.data.collapseTitle&&b.one(".js-title")&&b.one(".js-title").plug(a.rg.plugins.Expander,d),this.data.collapseAuthors&&b.one(".js-authors")&&b.one(".js-authors").plug(a.rg.plugins.Expander,d),this.data.collapseAbstract&&b.one(".js-abstract")&&b.one(".js-abstract").plug(a.rg.plugins.Expander,d),this.hasSeenPromo=!1,this.hasRequested=!1},externalPublicationRequest:function(b){b.preventDefault();var c=b.currentTarget,d=c.getData("context");this.get("preSignUpDialogContext")?a.rg.loadWidgetInDialog("publictopics.PreSignUpDialog.html",{context:this.get("preSignUpDialogContext")}):a.rg.loadWidgetInDialog("publicliterature.ExternalUserRequestFulltextDialog.html",{publicationUid:this.data.publicationUid,context:d},null,null,null,null,null,null,!0)},download:function(){this.data.showPublicationDownloadDataUsagePermissionDialog&&a.Lang.later(2e3,this,function(){a.rg.loadWidget("literature.PublicationDownloadDataUsagePermissionDialog.html",{},function(b){b.getDefaultDialogConfig=function(){return{hideOnClickOutside:!1,plugins:[{fn:a.Plugin.OverlayAutohide,cfg:{clickedOutside:!1,pressedEscape:!0,focusedOutside:!1}}]}};try{b.render({dialog:!0})}catch(c){return!1}})},this)},removeCitationPublication:function(){this.data.publicationCitationUid&&this.data.citationSourcePublicationUid?this.removeOutgoingCitationPublication():this.removeIncomingCitationPublication()},removeOutgoingCitationPublication:function(b){b&&b.preventDefault();var c=this;a.rg.confirm({header:"Remove Citation",body:"Are you sure you want to remove this citation?",buttons:[{id:"confirm",label:"Remove"},{id:"cancel",label:"Cancel"}],callback:function(b){"confirm"===b&&a.rg.ajaxDbwAware("publicliterature.PublicationCitationsList.removeCitation.html",{publicationUid:c.data.citationSourcePublicationUid,publicationCitationUid:c.data.publicationCitationUid},function(b){b.success?(a.Lang.isArray(b.result)&&1===b.result.length&&a.rg.notify(b.result[0],"attention"),this.get("container").remove(!0)):a.Lang.isArray(b.errors)&&1===b.errors.length?a.rg.notify(b.errors[0],"warning"):a.rg.notify("An error occurred.","warning")},c,{},"POST")}})},removeIncomingCitationPublication:function(b){b&&b.preventDefault();var c=this;a.rg.confirm({header:"Remove Citation",body:"Are you sure you want to remove this citation?",buttons:[{id:"confirm",label:"Remove"},{id:"cancel",label:"Cancel"}],callback:function(b){"confirm"===b&&a.rg.ajaxDbwAware("publicliterature.PublicationIncomingCitationsList.removeCitation.html",{citingPublicationUid:c.data.publicationUid,citedPublicationUid:c.data.citationSourcePublicationUid},function(b){b.success?(a.Lang.isArray(b.result)&&1===b.result.length&&a.rg.notify(b.result[0],"attention"),this.get("container").remove(!0)):a.Lang.isArray(b.errors)&&1===b.errors.length?a.rg.notify(b.errors[0],"warning"):a.rg.notify("An error occurred.","warning")},c,{},"POST")}})},showMoreContext:function(){var b=this.get("container"),c=b.one(".citation-context-item");return a.rg.ajax("application.AjaxCommon.ajaxScoreGoal.html",{goal:this.data.milestones.moreContext,viewIds:this.data.nextDetailPageExperimentViewId}),c.hasClass("show-more-context")?void c.removeClass("show-more-context"):(b.all(".js-context-show-more").removeClass("show-more-context"),void c.addClass("show-more-context"))},collapse:function(a){a.preventDefault();var b=this.get("container"),c=b.one(".abstract");c.toggleClass("collapsed")},_baseRemoveDialog:function(b,c,d){b.preventDefault();var e=this;a.rg.loadWidget("literature.PublicationRemoveDialog.html",{publicationUid:this.data.publicationUid,contextSource:c},function(a){a.on("publicationRemove",d,e),a.render({dialog:{}})})},remove:function(a){this._baseRemoveDialog(a,"profile",this.removePublication)},removeFromDepartmentpage:function(a){this._baseRemoveDialog(a,"department",this.removePublication)},removeFromProfile:function(a){this._baseRemoveDialog(a,"profile",this.removePublication)},removePublication:function(b){var c={publicationUid:this.data.publicationUid,reason:b.remove_option,reasonText:b.remove_text,contextSource:this.data.context,contextId:this.data.contextId},d=this.get("container");a.rg.ajaxDbwAware(this.publicationAuthorshipEndpoint,c,function(b){b.success&&a.rg.notify(b.result[0],"promo")},this,null,"DELETE"),d.hide("fadeOut",{},function(){d.remove(!0)})},sharePublication:function(b){b.preventDefault(),a.rg.loadWidgetInDialog("literature.PublicationShareDialog.html",{publicationUid:this.data.publicationUid})},toggleFollow:function(b){b.preventDefault();var c={publicationUid:this.data.publicationUid,context:this.get("followContext")};b.currentTarget.hasClass("animation-in-progress")||(this.followButtonStateChange(b.currentTarget,this.data.isReader),!this.data.isReader&&this.data.eventCode&&(c.eventCode=this.data.eventCode),a.rg.ajaxDbwAware(this.get("publicationBookmarkEndpointUrl"),c,function(c){return c.success?void a.rg.notify(c.result[0],"promo"):void this.followButtonStateChange(b.currentTarget,!this.data.isReader)},this,null,this.data.isReader?"DELETE":"POST"),this.data.isReader=!this.data.isReader)},followButtonStateChange:function(a,b){a.one(".js-btn-label").setContent(b?"Follow":"Following"),a.toggleClass("active")},onPreviewClosed:function(){this.openFulltextRequestInvitationDialog()},requestPrimary:function(a){return this.request(a,this.data.requestEndpointPrimary)},requestImage:function(a){return this.request(a,this.data.requestEndpointImage)},request:function(b,c){if(b&&b.preventDefault(),!b.currentTarget.hasClass("disabled")){var d=this,e={resourceId:this.data.publicationUid,context:this.data.eventCode?"pubitem-"+this.data.eventCode:"pubitem"};this.toggleDisableAllActions(),this.hasRequested=!this.hasRequested,this.changeFulltextRequestState(),this.data.nextPublicationMilestone&&this.data.nextPublicationViewId&&a.rg.ajax("application.AjaxCommon.ajaxScoreGoal.html",{goal:this.data.nextPublicationMilestone,viewIds:this.data.nextPublicationViewId}),a.rg.ajax(c,e,function(c){d.toggleDisableAllActions(),c.success?c.result.requested?(a.rg.notify("Full-text requested.","attention"),b.currentTarget.hasClass("image")&&d.get("opensViewer")||d.openFulltextRequestInvitationDialog(),d.undoTimeout=a.later(1e4,d,d.disableFurtherRequest,[b]),a.fire("fulltextRequested:publicationUid-"+d.data.publicationUid)):c.result.requestCancelled&&(a.rg.notify("Full-text request cancelled.","attention"),d.undoTimeout&&d.undoTimeout.cancel(),a.fire("fulltextRequestCancelled:publicationUid-"+d.data.publicationUid)):(a.rg.notify(c.errors,"warning"),d.hasRequested=!d.hasRequested,d.changeFulltextRequestState())})}},changeFulltextRequestState:function(){this.requestButtonStateChange(),this.previewFulltextStateChange()},toggleDisableAllActions:function(){var a=this.get("container"),b=a.one(".js-request-btn"),c=a.one(".action-request.image");c&&c.toggleClass("disabled"),b&&b.toggleClass("disabled")},requestButtonStateChange:function(){var a=this.get("container"),b=a.one(".js-request-btn");this.hasRequested&&b?(b.one(".js-btn-label").setContent("Full-text requested"),b.one(".js-icon")&&b.one(".js-icon").removeClass("hidden")):b&&(b.one(".js-btn-label").setContent("Request full-text"),b.one(".js-icon")&&b.one(".js-icon").addClass("hidden"))},previewFulltextStateChange:function(){var a=this.get("container"),b=a.one(".publication-preview");if(b&&b.one(".preview-action")){var c=b.one(".preview-action");this.hasRequested?(c.one(".text-request").addClass("hidden"),c.one(".text-requested").removeClass("hidden")):(c.one(".text-request").removeClass("hidden"),c.one(".text-requested").addClass("hidden"))}},disableFurtherRequest:function(b){b.currentTarget.addClass("btn-disabled"),b.currentTarget.addClass("requested"),a.fire("fulltextRequestFinished:publicationUid-"+this.data.publicationUid)},openFulltextRequestInvitationDialog:function(){!this.hasSeenPromo&&this.hasRequested&&(a.rg.loadWidget(this.get("requestFulltextInvitationDialogUrl"),{publicationUid:this.data.publicationUid},function(b){try{b.render({dialog:!0})}catch(c){a.log("Could not load widget.")}},this),this.hasSeenPromo=!0)}},{ATTRS:{requestEndpoint:{value:""},opensViewer:{value:!1},requestFulltextInvitationDialogUrl:{},followContext:{},publicationBookmarkEndpointUrl:{},preSignUpDialogContext:{}}})},"0.0.1",{requires:["rg-header-notify","transition","rg-confirm","rg-container-hover","rg-tooltip","rg-expander","rg-utils-url","rg-overlay-extension"]});
"use strict";YUI.add("rg.views.publicliterature.PublicationItemFulltextView",function(a){a.namespace("rg.views.publicliterature"),a.rg.views.publicliterature.PublicationItemFulltextView=a.Base.create("publicliterature.PublicationItemFulltextView",a.rg.WidgetView,[],{events:{".js-open-viewer":{click:"onOpenViewer"},".js-publication-item-fulltext":{mouseenter:"preloadViewer"},".js-external-request-fulltext":{click:"onExternalRequestFulltext"}},initializer:function(){this.once("rendered",function(){var b=this.get("container"),c=b.one(".js-show-source"),d=b.one(".js-citation-count-tooltip");if(c&&c.plug(a.rg.widget.TooltipPlugin,{content:b.one(".tooltip-content").getContent(),align:"right",arrowOffset:[10,0],overlayOffset:[10,0]}),this.data.previewUrl){var e=a.Node.create('<div class="preview-img"><img class="lazyload" data-src="'+this.data.previewUrl+'" /></div>');e.once("error",function(){e.remove()}),b.one(".js-publication-item-fulltext-content").prepend(e)}d&&d.plug(a.rg.widget.TooltipPlugin,{content:d.getAttribute("data-tooltip")})},this);var b="fulltextRequested:publicationUid-"+this.data.publicationUid,c="fulltextRequestCancelled:publicationUid-"+this.data.publicationUid,d="fulltextRequestFinished:publicationUid-"+this.data.publicationUid;this.events.global||(this.events.global={}),this.events.global[b]="onRequestFulltext",this.events.global[c]="onRequestFulltextCancelled",this.events.global[d]="onRequestFulltextFinished"},preloadViewer:function(){if(!this.data.disableViewer){var b=this;!b.preloaded&&b.data.linkId&&b.data.publicationUid&&b.data.previewUrl&&(b.preloaded=!0,a.rg.preloadWidget(this.data.documentViewerUrl,{},!0))}},onOpenViewer:function(b){if(!this.data.disableViewer){b.preventDefault();var c=this;c.data.linkId&&c.data.publicationUid&&a.rg.loadWidgetInDialog(this.data.documentViewerUrl,{},null,this)}},onExternalRequestFulltext:function(b){b.preventDefault();var c=b.currentTarget,d=c.getData("context");this.get("preSignUpDialogContext")?a.rg.loadWidgetInDialog("publictopics.PreSignUpDialog.html",{context:this.get("preSignUpDialogContext")}):a.rg.loadWidgetInDialog("publicliterature.ExternalUserRequestFulltextDialog.html",{publicationUid:this.data.publicationUid,context:d},null,null,null,null,null,null,!0)},onRequestFulltext:function(){var a=this.get("container"),b=a.one(".js-requests-info"),c=this.data.requestCount+1,d=c+" request";1!=c&&(d+="s"),b.setContent(d)},onRequestFulltextCancelled:function(){var a=this.get("container"),b=a.one(".js-requests-info"),c=this.data.requestCount+" request";1!=this.data.requestCount&&(c+="s"),b.setContent(c)},onRequestFulltextFinished:function(){this.data.hasRequested=!0,this.data.requestCount++,this.render({refresh:!0}),this.initializer()}},{ATTRS:{preSignUpDialogContext:{}}})},"0.0.1",{requires:["rg-header-notify","transition","rg-tooltip","rg-overlay-extension"]});
YUI.add("rg-filter-menu",function(a){a.namespace("rg.plugins");var b=function(a){var b,c;a.hasClass("filter-item")?(b=a.one(".filter-link-indicator"),c=a.one(".filter-link").get("offsetTop")):(b=a.ancestor(".filter-item").one(".filter-link-indicator"),c=a.get("offsetTop")),b.setStyle("top",c)};a.rg.plugins.FilterMenu=a.Base.create("FilterMenu",a.Plugin.Base,[],{initializer:function(){var a,c=this.get("host"),d=c.one(".selected");d&&(a=d.one(".selected")),a?b(a):d&&b(d)}},{NS:"FilterMenu"}),a.rg.plugins.pushStateHandleMainFilter=function(c){var d=c.ancestor(".filter-list-container"),e=c.one(".toggle-container");if(!c.hasClass("empty")&&!c.hasClass("selected")&&(d.all(".selected").removeClass("selected"),c.addClass("selected"),d.all(".filter-link-indicator").setStyle("top","0"),b(c),!c.hasClass("expanded"))){var f=function(){d.all(".expanded").removeClass("expanded"),c.addClass("expanded"),e&&a.rg.slideToggle(e,function(){})};d.one(".expanded .toggle-container")?a.rg.slideToggle(d.one(".expanded .toggle-container"),f):f()}},a.rg.plugins.pushStateHandleSubFilter=function(c){var d=c.ancestor(".filter-item"),e=d.all(".filter-subfilter-item");c.hasClass("empty")||(a.rg.plugins.pushStateHandleMainFilter(d),d.removeClass("selected"),e.removeClass("selected"),c.addClass("selected"),b(c))}},"0.0.1",{requires:[]});
YUI.add("rg.views.publicprofile.ProfileContributionsFilterMenuView",function(a){a.namespace("rg.views.publicprofile"),a.rg.views.publicprofile.ProfileContributionsFilterMenuView=a.Base.create("publicprofile.ProfileContributionsFilterMenuView",a.rg.WidgetView,[],{events:{global:{"profileContributionsFilterMenu:submenuItemChanged":"submenuItemChanged","profileContributionsFilterMenu:menuItemChanged":"menuItemChanged"}},afterRendered:function(){var b=this.get("container");b.plug(a.rg.plugins.FilterMenu)},menuItemChanged:function(b){a.rg.plugins.pushStateHandleMainFilter(a.one(b.additionalEventPayload))},submenuItemChanged:function(b){a.rg.plugins.pushStateHandleSubFilter(a.one(b.additionalEventPayload))}})},"0.0.1",{requires:["rg-filter-menu"]});
"use strict";YUI.add("rg.views.publicprofile.ProfileContributionsFilterMenuFollowersItemView",function(a){a.namespace("rg.views.publicprofile"),a.rg.views.publicprofile.ProfileContributionsFilterMenuFollowersItemView=a.Base.create("publicprofile.ProfileContributionsFilterMenuFollowersItemView",a.rg.WidgetView,[],{events:{".js-link":{click:"openDialog"}},openDialog:function(b){this.data.preSignUpDialogContext&&(b.preventDefault(),a.rg.loadWidgetInDialog("publictopics.PreSignUpDialog.html",{context:this.data.preSignUpDialogContext}))}})},"0.0.1",{requires:[]});
